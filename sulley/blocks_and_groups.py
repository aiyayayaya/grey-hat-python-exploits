from sulley import *

# fuzzing request: {GET, HEAD, POST, TRACE} /index.html HTTP/1.1
# define a new block named "HTTP BASIC"

s_initialize("HTTP BASIC")

# define a group primitive listing the various HTTP we wish to fuzz
s_group("verbs", values=["GET", "HEAD", "POST", "TRACE"])

# define a new block named "body" and associate with the above group
if s_block_start("body", group='verbs'):
    # break the remainder of the HTTP request into primitives
    s_delim(" ")
    s_delim("/")
    s_string("index.html")
    s_delim(" ")
    s_string("HTTP")
    s_delim("/")
    s_string("1")
    s_delim(".")
    s_string("1")

    # end the request with the mandatory static sequence
    s_static("\r\n\r\n")
    
# close the open block, the name argument is optional here
s_block_end("body")